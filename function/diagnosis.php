<?php	/******************************************************************************/	/***						Diagnosis function				                ***/	/***							Диагнозы									***/	/******************************************************************************/		if($_GET['cat']=="diagnosis"){$results['cat'] = "diagnosis";}else{return;}		$results['link'] = "?action=catalog&cat=diagnosis";	$results['sAct'] = isset($_GET['sAct']) ? $_GET['sAct'] : null ;	$results['res'] = isset($_GET['res']) ? $_GET['res'] : null ;	$results['GETid'] = isset($_GET['id']) ? $_GET['id'] : null ;	require_once ( CLASS_PATH . '/catalog/Diagnosis.php' );	// Весь список объектов	$list = new Diagnosis();	$results['list'] = $list->getAll();		if(isset($_GET['archive']) && $_GET['archive']=='on'){		$results['list'] = $list->archive();		$results['link'] .= "&archive=on";	}	// Выборка выбранного объекта	$results['ids'] = isset($_GET['id']) ? $_GET['id'] : null;	if($results['ids']){		foreach($results['list'] as $param=>$value){			foreach($value as $par=>$val){				if($par=='id'){					if($val==$results['ids']){						$results['id']=$value;					}				}			}		}	}		// Получение сторонних данных	require_once ( CLASS_PATH . '/catalog/Print043.php' );		$print043 = new Print043();		$results['print043'] = $print043->getAll();	require_once ( CLASS_PATH . '/catalog/Diagnosis_type.php' );		$diagnosis_type = new Diagnosis_type();		$results['diagnosis_type'] = $diagnosis_type->getAll();	require_once ( CLASS_PATH . '/catalog/IllDestination.php' );		$illDestination = new IllDestination();		$results['illDestination'] = $illDestination->getAll();		// Проверка действий	$sAct = isset($_GET['sAct']) ? $_GET['sAct'] : "";	switch($sAct){		case 'new':				$results[] = $results['link'];				$results[] = $results['cat'];				newObject($results);			break;		case 'insert':				insert($_REQUEST);			break;		case 'update':				update($_REQUEST);			break;		case 'delete':				delete($results['GETid']);			break;		default:			if(isset($_REQUEST['hidden'])){				$results['list'] = null;				def($results);			}else{def($results);}				}	function def($results){		require_once ( TEMPLATE_PATH . '/catalog/diagnosis.php' );	}	function newObject($results){		require_once ( TEMPLATE_PATH . '/catalog/diagnosis.php' );	}	function insert($results){		$insert = new Diagnosis();				$insert->set($results);		$res =	$insert->insert();		header( "Location: ?action=catalog&cat=diagnosis&res=".$res );	}	function update($results){		$update = new Diagnosis();				$update->set($results);		$res =	$update->update();		header( "Location: ?action=catalog&cat=diagnosis&id=".$results['id']."&res=".$res );	}	function delete($id){		print($id);		$delete = new Diagnosis();				$delete->setID($id);		$res =	$delete->delete();		header( "Location: ?action=catalog&cat=diagnosis&res=".$res );	}	?>