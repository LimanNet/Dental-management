<?php	/******************************************************************************/	/***						Tooth State Template			                ***/	/***						Графика зубной формулы							***/	/******************************************************************************/	if(!$results['cat']){return;}	if( isset($_REQUEST['hidden']) ){		hidden($results);	}	else{		show($results);	}?><?phpfunction show($results){echo'<script>function chang(str){    $(".select").removeClass("select");    $("#l"+str).addClass("select");	$("#txtHint").load("'.$results['link'].'&hidden=on&id="+str);}$(document).ready(function(){	if($("div").is(".status")){		$(".success").addClass("select");		$(".success").delay(2000).slideUp(300);	}		});</script><script LANGUAGE="JavaScript"><!--function confirmSubmit(){var agree=confirm(	"Удаление данного элемента приведёт к нарушению отчётности!\n\n"	+"\tВы действительно желаете удалить этот Диагноз?");if (agree)	return true ;else	return false ;}// --></script><table border="1" width="100%"><thead>	Графика зубной формулы';		if(isset($results['res'])){		if($results['res']=='success'){			echo'			<div class="status success">				<p>Операция выполнена успешно.</p>				<div class="tn-progress"></div>			</div>						';}		else{echo' | <b>' . $results['res'].'</b>';}	}echo'</thead><tbody>	<tr>		<td width="30%">';/***						Левая панель перечисления			                ***/ echo'		<div class="lists">			<table class="list">				<tr>					<th>Цвет</th>					<th>Название</th>				</tr>					<form>				';								if(!$results['list']){ echo "<tr><td>Данных нет</td></tr>";}				else{					foreach( $results['list'] as $value ){						if($value['id']==$results['GETid']){							echo '<tr class="lis selected" onclick="chang(\''.$value['id'].'\')" id="l'.$value['id'].'" id="l'.$value['id'].'"> ';						}else{							echo '<tr onclick="chang(\''.$value['id'].'\')" id="l'.$value['id'].'" class="lis"> ';						}						echo '<td style="background-color:'.$value['color'].'"></td>';						echo '<td>'.$value['name'].'</td>';												echo "</tr></form>";					}				}			echo'			</table>			</div>			</td>		<td width="70%">';		/***						Правая панель		                ***/echo'<div id="txtHint">';								// Дополнительные данные				$res['toothPart'] = $results['toothPart'];								// Основные переменные				$res['link'] = $results['link'];				$res['sAct'] = $results['sAct'];				$res['id'] = isset($results['id']) ?  $results['id'] : null;				$res['cat'] = $results['cat'];									if(isset($results['GETid']) || isset($results['sAct'])){										if($res['id']){						if($res['id']['archived']){disabledForm($res);}						else{activeForm($res);}					}else{						newForm($res);					}									}				else{ topform($res); }				echo'			</div>		</td>	</tr></tbody></table>';}function hidden($results){echo'<div id="txtHint">';								// Дополнительные данные				$res['toothPart'] = $results['toothPart'];								// Основные переменные				$res['link'] = $results['link'];				$res['sAct'] = $results['sAct'];				$res['id'] = isset($results['id']) ?  $results['id'] : null;				$res['cat'] = $results['cat'];												if(isset($results['GETid']) || isset($results['sAct'])){					if($res['id']){						if($res['id']['archived']){disabledForm($res);}						else{activeForm($res);}					}else{						newForm($res);					}				}				else{ topform($res); }echo'</div>';				}	function topform($result){		echo '			<div class="actions button-container button-group">				<a class="button big" href="'.$result['link'].'&sAct=new">Новая графика</a>				<a class="button big" href="'.$result['link'].'&archive=off">Каталог</a>				<a class="button big" href="'.$result['link'].'&archive=on">Архив</a>			</div>			<br><hr><br>		';	}	function newForm($result){		echo '<form id="form" method="post" action="'.$result['link'].'&sAct=insert" >';		echo '<input type="hidden" formmethod="get" name="action" value="catalog" />';		echo '<input type="hidden" formmethod="get" name="cat" value="diagnosis" />';				echo '			<div class="actions button-container">				<a href="'.$result['link'].'&sAct=new" class="button primary icon add">Новая графика</a>    				<div class="button-group">					<input form="form" type="submit" value="Сохранить" class="button primary" />					<input form="form" type="reset" value="Отменить" class="button" />				</div>                        				<div class="button-group minor-group">					<a href="'.$result['link'].'" class="button">К списку</a>					<a href="./admin.php" class="button">Выйти</a>									</div>			</div>		';		echo '</form>';				echo '<hr>';		echo 'Название*:';			echo '<input name="name" form="form" type="text" size="100" required /><br/>';		echo 'Выбор цвета для обозначения:';			echo '<input name="color" form="form" type="color" required /><br/>';				echo '<fieldset>';		echo '<legend>Назначить доступные области для обозначения:</legend>';			foreach($result['toothPart'] as $value){				echo '<input form="form" type="checkbox" name="ids_tooth_part[]" value="'.$value['id'].'">'.$value['name'].'<Br>';			}		echo '</fieldset>';			}		function activeForm($result){		// Кнопки управления		echo '<form id="form" method="post" action="'.$result['link'].'&id='. $result['id']['id'] .'&sAct=update">';						echo '			<div class="actions button-container">				<a href="'.$result['link'].'&sAct=new" class="button primary icon add">Новая графика</a>    				<div class="button-group">					<input form="form" type="submit" value="Сохранить изменения" class="button primary" />					<input form="form" type="reset" value="Отменить" class="button" />					<input form="form" type="submit" value="В архив" class="button" formaction="?action=catalog&cat='.$result['cat'].'&id='. $result['id']['id'] .'&sAct=update&archived=1" />					<a href="'.$result['link'].'&id='. $result['id']['id'] .'&sAct=delete" onclick="return confirmSubmit()" class="button danger">Удалить</a>				</div>                        				<div class="button-group minor-group">					<a href="'.$result['link'].'" class="button">К списку</a>					<a href="./admin.php" class="button">Выйти</a>									</div>			</div>		';					echo '</form>';		echo '<hr>';				echo '<input type="hidden" formmethod="get" name="id" value="'.$result['id']['id'].'" form="form" />';				echo 'Название*:';			echo '<input name="name" form="form" type="text" size="100" value="'.$result['id']['name'].'" required /><br/>';		echo 'Выбор цвета для обозначения:';			echo '<input name="color" form="form" type="color" value="'.$result['id']['color'].'" required /><br/>';				echo '<fieldset>';		echo '<legend>Назначить доступные области для обозначения:</legend>';					$result['id']['ids_tooth_part'] = explode(",", $result['id']['ids_tooth_part']);						foreach($result['toothPart'] as $value){				if( in_array($value['id'],$result['id']['ids_tooth_part']) ){					echo '<input name="ids_tooth_part[]" checked form="form" type="checkbox" value="'.$value['id'].'" >'.$value['name'].'<Br>';				}else{					echo '<input name="ids_tooth_part[]" form="form" type="checkbox" value="'.$value['id'].'">'.$value['name'].'<Br>';				}			}		echo '</fieldset>';	}		function disabledForm($result){		// Кнопки управления		echo '<form id="form" method="post" action="'.$result['link'].'&id='. $result['id']['id'] .'&sAct=update">';		echo '<input type="hidden" name="archived" value="" form="form" />';		echo '<input type="hidden" formmethod="get" name="id" value="'.$result['id']['id'].'" form="form" />';		echo '			<div class="actions button-container">				<a href="'.$result['link'].'&sAct=new" class="button primary icon add">Новая графика</a>    				<div class="button-group">					<input form="form" type="submit" value="Восстановить" class="button" formaction="'.$result['link'].'&id='. $result['id']['id'] .'&sAct=update" />					<a href="'.$result['link'].'&id='. $result['id']['id'] .'&sAct=delete" onclick="return confirmSubmit()" class="button danger">Удалить</a>				</div>                        				<div class="button-group minor-group">					<a href="'.$result['link'].'" class="button">К списку</a>					<a href="./admin.php" class="button">Выйти</a>									</div>			</div>		';					echo '</form>';		echo '<hr>';		foreach($result['id']as$param=>$value){			if($param!='archived'){echo '<input type="hidden" name="'.$param.'" value="'.$value.'" form="form" />';}		}		echo '<input type="hidden" formmethod="get" name="id" value="'.$result['id']['id'].'" form="form" />';						echo 'Название*:';			echo '<input disabled name="name" form="form" type="text" size="100" value="'.$result['id']['name'].'" required /><br/>';		echo 'Выбор цвета для обозначения:';			echo '<input disabled name="color" form="form" type="color" value="'.$result['id']['color'].'" required /><br/>';				echo 'Назначить доступные области для обозначения*:';			echo '<select disabled form="form" name="ids_tooth_part" required />';				echo '<option></option>';				foreach($result['toothPart'] as $value){						echo '<option value="'.$value['id'].'">'.$value['name'].'</option>';				}			echo '<select/><br/>';				}?>