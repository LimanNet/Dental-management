<?php	require_once( TEMPLATE_PATH . '/include/header.php' );	require_once( CLASS_PATH . "/Patient.php");?><script>$(document).ready(function(){	$(".but").click(function(){$(".left").toggle();});	});</script><table border="1" width="100%">	<tr>		<div class="hid"><td class="left"><?php listPatientsTab();	?></td></div>		<td class="right">			<?php viewPatientTab();	?>		</td>	</tr></table><?php include( TEMPLATE_PATH . '/include/footer.php' );?><?phpfunction listPatientsTab(){	//echo 'List patients';	listPatients();}function viewPatientTab(){	$tab = (isset($_GET['tab']) ? $_GET['tab'] : null);	switch( $tab ){		case 'newPatient':			newPatient();			break;		case 'viewPatient':			viewPatient();			break;		case 'editPatient':			editPatient();			break;		case 'deletePatient':			deletePatient();			break;		case 'listPatients':			listPatients();			break;		case 'viewMedicalInfo':			viewMedicalInfo();			break;		case 'editMedicalInfo':			editMedicalInfo();			break;		case 'appointments':			appointments();			break;		case 'dentition':			dentition();			break;		case 'survey':			survey();			break;		default:			viewPatient();	}}function newPatient(){		$results = array();	$results['pageTitle'] = "Создание новой карты";	$results['formAction'] = "newPatient";			$res=array();	if ( isset( $_POST['saveChanges'] ) ) {		$insert = new Patient();		$insert -> insert($_POST);		header( "Location: ?action=patients&status=changesSaved" );	} elseif ( isset( $_POST['cancel'] ) ) {		// User has cancelled their edits: return to the patient list		header( "Location: ?status=cancelled" );		}	$results['patient'] = null;	require_once(TEMPLATE_PATH . "/Patient/editPatient.php");	}  function editPatient(){		require_once( CLASS_PATH . "/Patient.php");		$res=array();	if ( isset( $_POST['saveChanges'] ) ) {		if(isset($_POST['id'])){			(int)$id=$_POST['id'];		}else{			header( "Location: ?status=error" );		}		$insert = new Patient($_POST);		$insert -> update();		header( "Location: ?action=viewPatient&patientId=".$id."&status=changesSaved" );	} elseif ( isset( $_POST['cancel'] ) ) {		// User has cancelled their edits: return to the patient list		header( "Location: ?status=cancelled" );		}		$results = array();	$results['pageTitle'] = "Изменение карточки пациента(ки)";	$results['formAction'] = "editPatient";		$idPatient = (int) isset($_GET['patientId']) ? $_GET['patientId'] : "";	$data = array(		'id'=>$idPatient	);	$patient = new Patient($data);	$results['patient'] = $patient->getById();	require_once( TEMPLATE_PATH . "/Patient/editPatient.php");}function viewPatient(){		$results = array();	$results['pageTitle'] = "View Patient";	$results['formAction'] = "viewPatient";			$idPatient = (int) isset($_GET['patientId']) ? $_GET['patientId'] : null;	$data = array(		'id'=>$idPatient	);	if(isset($_GET['patientId'])){		$patient = new Patient($data);		$results['patient'] = $patient->getById();				if($results['patient']){			require_once( TEMPLATE_PATH . "/Patient/viewPatient.php");		}else{			header( "Location: ?status=notPatient" );		}	} else {		echo '<a href="?action=Patients&amp;tab=newPatient" class="button">Новая карта</a>';		listPatients();	}}function listPatients() {		$results = array();		$idDoctor = $_SESSION['idDoctor'];		$Patients = new Patient();	$getPatients = $Patients->getAll();		$results['patients'] = $getPatients;		require( TEMPLATE_PATH . "/Patient/listPatients.php" );}function deletePatient(){	}	/* Медицинские сведения */function viewMedicalInfo(){		$results = array();		//require_once( TEMPLATE_PATH . "/Patient/viewMedicalInfo.php" );	editMedicalInfo();}function editMedicalInfo(){	require_once( CLASS_PATH . "/MedicalInfo.php");		$res=array();	if ( isset( $_POST['saveChanges'] ) ) {		if(isset($_POST['id'])){			(int)$id=$_POST['id'];		}else{			header( "Location: ?status=error" );		}		$insert = new MedicalInfo($_POST);		$insert -> update();		header( "Location: ?action=patient&tab=editMedicalInfo&patientId=".$id."&status=changesSaved" );	} elseif ( isset( $_POST['cancel'] ) ) {		// User has cancelled their edits: return to the patient list		header( "Location: action=patient&tab=viewMedicalInfo&patientId=".$id."&status=cancelled" );		}		$results = array();	$results['pageTitle'] = "Изменение карточки пациента(ки)";	$results['formAction'] = "editMedicalInfo";		$idPatient = (int) isset($_GET['patientId']) ? $_GET['patientId'] : "";	$data = array(		'id'=>$idPatient	);		$medicalInfo = new MedicalInfo($data);	$medicalInfo = $medicalInfo->getById();			require_once( 'classes/Patient.php' );				/* Список типов прикуса */		require_once( 'classes/Catalog/TypeBite.php' );				$typeBite = new TypeBite();		$typeBite = $typeBite->getAll();				$result['typeBite'] = $typeBite;				/* Список цветов по Vita  */		require_once( 'classes/Catalog/VitaColor.php' );				$vitaColor = new VitaColor();		$vitaColor = $vitaColor->getAll();				$result['vitaColor'] = $vitaColor;				/* Список врачей */		require_once( 'classes/Doctors.php' );				$doctors = new Doctors();		$doctors = $doctors->getAll();				$result['doctors'] = $doctors;				/*	Список перенесённых болезней */		require_once( 'classes/Catalog/Illness.php' );				$illness = new Illness();		$illness = $illness->getAll();				$result['illness'] = $illness;			require_once( TEMPLATE_PATH . "/Patient/editMedicalInfo.php");}	/**	**	** Приёмы 	**	**/function appointments(){	require_once( CLASS_PATH . "/Patient.php" );		require_once( TEMPLATE_PATH . "/Patient/appointments.php" );}	/* Зубная формула */function dentition(){	require_once( TEMPLATE_PATH . "/Patient/dentition.php" );}		/* Обследования */function survey(){	require_once( CLASS_PATH . "/Patient.php" );		require_once( TEMPLATE_PATH . "/Patient/survey.php" );}?>